<% content_for :title, "Reviews" %>
<div class="review-index" data-sticky-container>
  <div class="entities-list-wrapper">
    <div class="entities-list entities-list--full-height js-sticky">
        <%= form_tag project_entities_path, method: :get do %>
        <%= text_field_tag :query,
          params[:query],
          class: "form-control sticky-search",
          placeholder: "type keyword"
        %>
      <% end %>
      <ul class="list-group list-group-flush entities-list-item">
        <% @all_entities_in_project.each do  |entity| %>
        <%= link_to project_reviews_path(@project, :entity_id => entity.id) do %>
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <%= entity.name %>
              <% result =  entity.avg_sentiment %>
              <% if result > 1 %>
                <h6><span class="badge badge-success badge-pill black-text"><%= entity.occurrences %></span></h6>
              <% elsif result < 1 && result > 0 %>
                <h6><span class="badge badge-primary badge-pill"><%= entity.occurrences %></span></h6>
              <% else %>
                <h6><span class="badge badge-danger badge-pill"><%= entity.occurrences %></span></h6>
              <% end %>
            </li>
        <% end %>
        <% end %>
      </ul>
    </div>
  </div>

  <table class="table-borderless">
    <thead>
      <tr>
      </tr>
    </thead>
    <tbody>
       <% @reviews.each do |review| %>
      <tr>
        <td> <i class="fas fa-quote-left"></i> <%= review.comments %> <i class="fas fa-quote-right"></i> <br> <i style="color:gray">- <%= review.date %> </td></i>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>

